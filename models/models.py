from flask import Flask
from flask_sqlalchemy import SQLAlchemy

app = Flask(__name__)
app.config['SQLALCHEMY_DATABASE_URI'] = 'sqlite:///symbolism.db'
app.config['SQLALCHEMY_TRACK_MODIFICATIONS'] = False

db = SQLAlchemy(app)

class AbjadValue(db.Model):
    __tablename__ = 'abjad_values'
    id = db.Column(db.Integer, primary_key=True)
    letter = db.Column(db.String(2), unique=True, nullable=False)
    value = db.Column(db.Integer, nullable=False)

class NumberSymbolism(db.Model):
    __tablename__ = 'number_symbolism'
    id = db.Column(db.Integer, primary_key=True)
    number = db.Column(db.Integer, unique=True, nullable=False)
    meaning = db.Column(db.Text, nullable=False)

class ExtendedSymbolism(db.Model):
    __tablename__ = 'extended_symbolism'
    id = db.Column(db.Integer, primary_key=True)
    size = db.Column(db.Integer, unique=True, nullable=False)
    meaning = db.Column(db.Text, nullable=False)

class PlanetaryInfo(db.Model):
    __tablename__ = 'planetary_info'
    id = db.Column(db.Integer, primary_key=True)
    size = db.Column(db.Integer, unique=True, nullable=False)
    planet = db.Column(db.String(50), nullable=False)
    day = db.Column(db.String(50), nullable=False)
    metal = db.Column(db.String(50), nullable=False)
    description = db.Column(db.Text, nullable=False)

class DivineName(db.Model):
    __tablename__ = 'divine_names'
    id = db.Column(db.Integer, primary_key=True)
    name = db.Column(db.String(100), nullable=False)
    value = db.Column(db.Integer, nullable=False)
    meaning = db.Column(db.Text, nullable=False)
    planet = db.Column(db.String(50), default="")
    usage = db.Column(db.Text, default="")

if __name__ == '__main__':
    with app.app_context():
        db.drop_all()
        db.create_all()

        abjad_data = {
            'ا': 1, 'أ': 1, 'إ': 1, 'آ': 1, 'ب': 2, 'ج': 3, 'د': 4, 'ه': 5, 'ة': 5,
            'و': 6, 'ؤ': 6, 'ز': 7, 'ح': 8, 'ط': 9, 'ي': 10, 'ى': 10, 'ئ': 10, 'ی': 10,
            'ك': 20, 'ل': 30, 'م': 40, 'ن': 50, 'س': 60, 'ع': 70, 'ف': 80, 'ص': 90,
            'ق': 100, 'ر': 200, 'ش': 300, 'ت': 400, 'ث': 500, 'خ': 600, 'ذ': 700,
            'ض': 800, 'ظ': 900, 'غ': 1000
        }

        db.session.bulk_insert_mappings(AbjadValue, [
            {'letter': k, 'value': v} for k, v in abjad_data.items()
        ])

        number_meanings = {
            1: "الأصل والبداية، الوحدة، الخلق الأول",
            2: "الازدواج، التوازن، الذكر والأنثى",
            3: "التكامل الأولي، التثليث، الحياة",
            4: "الاستقرار والمادة، العناصر الأربعة",
            5: "الإنسان، الجسد، الحواس الخمس",
            6: "الانسجام، التوازن بين المادة والروح",
            7: "الروح، الحكمة، الأسرار، السماوات السبع",
            8: "اللانهاية، القدر، التحكم",
            9: "الكمال، الإتمام، آخر مراحل التطور"
        }

        db.session.bulk_insert_mappings(NumberSymbolism, [
            {'number': k, 'meaning': v} for k, v in number_meanings.items()
        ])

        extended_symbolism = {
            10: "رمز الاكتمال الأرضي والنظام الإنساني",
            11: "البوابة الروحية والوعي العالي",
            12: "الزمن والدورات الكونية",
            13: "التحول الداخلي، والموت الرمزي",
            14: "الاتزان بين السماء والأرض (7+7)",
            15: "التكامل بين القوى العليا والدنيا",
            16: "العوالم الرباعية والاكتمال الكوني",
            17: "رمز النضج والإنجازات الكبرى",
            18: "رمز القوة المضاعفة والإنضباط الداخلي",
            19: "الإدراك الكامل للدورة الكونية والنور الباطن"
        }

        db.session.bulk_insert_mappings(ExtendedSymbolism, [
            {'size': k, 'meaning': v} for k, v in extended_symbolism.items()
        ])

        planetary_data = {
            3: {"planet": "زحل", "day": "السبت", "metal": "الرصاص", "description": "الثبات والحكمة والانضباط"},
            4: {"planet": "المشتري", "day": "الخميس", "metal": "القصدير", "description": "الوفرة والبركة والحكمة"},
            5: {"planet": "المريخ", "day": "الثلاثاء", "metal": "الحديد", "description": "القوة والطاقة والقتال"},
            6: {"planet": "الشمس", "day": "الأحد", "metal": "الذهب", "description": "السلطة، النجاح، والإشراق"},
            7: {"planet": "الزهرة", "day": "الجمعة", "metal": "النحاس", "description": "الحب، الجمال، الفن"},
            8: {"planet": "عطارد", "day": "الأربعاء", "metal": "الزئبق", "description": "الفكر، الاتصالات، الذكاء"},
            9: {"planet": "القمر", "day": "الإثنين", "metal": "الفضة", "description": "الخيال، العاطفة، التغير"}
        }

        db.session.bulk_insert_mappings(PlanetaryInfo, [
            {'size': k, **v} for k, v in planetary_data.items()
        ])

        names_with_meanings = [
            ("الله", "الاسم الجامع لكل صفات الكمال"),
            ("الرحمن", "ذو الرحمة الشاملة في الدنيا والآخرة"),
            ("الرحيم", "كثير الرحمة بالمؤمنين"),
            ("الملك", "المالك المتصرف في شؤون الخلق"),
            ("القدوس", "المنزه عن كل نقص"),
            ("السلام", "المانح للسلام والأمان"),
            ("المؤمن", "الذي يؤمن عباده من الخوف"),
            ("المهيمن", "المسيطر والرقيب على كل شيء"),
            ("العزيز", "الذي لا يُغلب"),
            ("الجبار", "الذي يجبر الكسر"),
            ("المتكبر", "المتعالي عن صفات المخلوقين"),
            ("الخالق", "الذي خلق كل شيء من العدم"),
            ("البارئ", "الذي يخلق بلا مثال"),
            ("المصور", "الذي صوّر خلقه كيف يشاء"),
            ("الغفار", "الذي يغفر الذنوب جميعًا"),
            ("القهار", "الذي يقهر الجبابرة والعصاة"),
            ("الوهاب", "كثير العطاء بلا مقابل"),
            ("الرزاق", "الذي يرزق الخلق جميعًا"),
            ("الفتاح", "الذي يفتح أبواب الخير"),
            ("العليم", "العالم بكل شيء"),
            ("القابض", "الذي يضيق الأرزاق بحكمة"),
            ("الباسط", "الذي يوسع الأرزاق بحكمة"),
            ("الخافض", "الذي يخفض من يشاء بحكمته"),
            ("الرافع", "الذي يرفع من يشاء بفضله"),
            ("المعز", "الذي يمنح العزة لمن يشاء"),
            ("المذل", "الذي يذل من يشاء بعدله"),
            ("السميع", "الذي يسمع كل شيء"),
            ("البصير", "الذي يرى كل شيء"),
            ("الحكم", "الذي يحكم بين عباده بالعدل"),
            ("العدل", "الذي يعدل في حكمه"),
            ("اللطيف", "الرفيق بعباده، يوصل الخير بلطف"),
            ("الخبير", "الذي يعلم دقائق الأمور"),
            ("الحليم", "الذي لا يعجل بالعقوبة"),
            ("العظيم", "الذي لا يحيط به عقل"),
            ("الغفور", "كثير المغفرة"),
            ("الشكور", "الذي يشكر عباده على الطاعات"),
            ("العلي", "المرتفع عن صفات الخلق"),
            ("الكبير", "الذي لا شيء أكبر منه"),
            ("الحفيظ", "الذي يحفظ عباده وأعمالهم"),
            ("المقيت", "الذي يوصل القوت إلى خلقه"),
            ("الحسيب", "الذي يكفي عباده ويحاسبهم"),
            ("الجليل", "العظيم ذو العزة والوقار"),
            ("الكريم", "الذي يعطي بلا مقابل"),
            ("الرقيب", "الذي يراقب كل شيء"),
            ("المجيب", "الذي يجيب دعاء من دعاه"),
            ("الواسع", "الذي وسع كل شيء علمًا وقدرة"),
            ("الحكيم", "الذي يضع الأمور في مواضعها"),
            ("الودود", "الذي يحب عباده الصالحين"),
            ("المجيد", "الذي له المجد والكمال"),
            ("الباعث", "الذي يبعث الخلق يوم القيامة"),
            ("الشهيد", "الذي لا يغيب عنه شيء"),
            ("الحق", "الثابت الذي لا يتغير"),
            ("الوكيل", "الذي يُتوكل عليه في كل أمر"),
            ("القوي", "الذي لا يُغلب"),
            ("المتين", "الثابت الذي لا يُقهر"),
            ("الولي", "الناصر لعباده المؤمنين"),
            ("الحميد", "المحمود على كل حال"),
            ("المحصي", "الذي أحصى كل شيء عددًا"),
            ("المبدئ", "الذي بدأ الخلق"),
            ("المعيد", "الذي يعيده بعد الموت"),
            ("المحيي", "الذي يحيي الأجساد"),
            ("المميت", "الذي يميت الأجساد"),
            ("الحي", "الذي لا يموت"),
            ("القيوم", "القائم بنفسه المقيم لغيره"),
            ("الواجد", "الذي لا يعوزه شيء"),
            ("الماجد", "ذو المجد والشرف الكامل"),
            ("الواحد", "المنفرد في ذاته وصفاته"),
            ("الصمد", "الذي يُقصد في الحوائج كلها"),
            ("القادر", "الذي يقدر على كل شيء"),
            ("المقتدر", "الذي لا يعجزه شيء"),
            ("المقدم", "الذي يقدم من يشاء"),
            ("المؤخر", "الذي يؤخر من يشاء"),
            ("الأول", "الذي ليس قبله شيء"),
            ("الآخر", "الذي ليس بعده شيء"),
            ("الظاهر", "الذي ظهر لكل خلقه"),
            ("الباطن", "الذي لا تدركه الأبصار"),
            ("الوالي", "المالك المدبر لأمور الخلق"),
            ("المتعالي", "المنزه عن صفات الخلق"),
            ("البر", "الذي يحسن إلى عباده"),
            ("التواب", "الذي يقبل التوبة عن عباده"),
            ("المنتقم", "الذي ينتقم من الظالمين"),
            ("العفو", "الذي يمحو الذنوب"),
            ("الرؤوف", "الذي يرق بعباده"),
            ("مالك الملك", "المالك الحقيقي لكل شيء"),
            ("ذو الجلال والإكرام", "صاحب العظمة والكرم"),
            ("المقسط", "الذي يقيم العدل"),
            ("الجامع", "الذي يجمع الخلق للجزاء"),
            ("الغني", "الذي لا يحتاج إلى أحد"),
            ("المغني", "الذي يُغني من يشاء"),
            ("المانع", "الذي يمنع الضر عن عباده"),
            ("الضار", "الذي يصيب بالضر من يشاء لحكمة"),
            ("النافع", "الذي ينفع عباده"),
            ("النور", "الذي أنار السماوات والأرض"),
            ("الهادي", "الذي يهدي من يشاء"),
            ("البديع", "الذي خلق بغير مثال"),
            ("الباقي", "الذي لا يفنى"),
            ("الوارث", "الذي يرث الأرض ومن عليها"),
            ("الرشيد", "الذي يرشد عباده للصواب"),
            ("الصبور", "الذي لا يعجل بالعقوبة")
        ]

        db.session.bulk_insert_mappings(DivineName, [
            {'name': name, 'value': sum(abjad_data.get(char, 0) for char in name), 'meaning': meaning}
            for name, meaning in names_with_meanings
        ])

        db.session.commit()
        print("✅ تم إنشاء قاعدة البيانات والجداول وإدخال جميع البيانات بنجاح.")
